--
-- Script was generated by Devart dbForge Studio 2019 for MySQL, Version 8.1.22.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 03.04.2020 0:20:23
-- Server version: 5.5.5-10.4.8-MariaDB
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Drop table `timetable`
--
DROP TABLE IF EXISTS timetable;

--
-- Drop table `classrooms`
--
DROP TABLE IF EXISTS classrooms;

--
-- Drop table `groups`
--
DROP TABLE IF EXISTS groups;

--
-- Drop table `subjects`
--
DROP TABLE IF EXISTS subjects;

--
-- Drop table `teachers`
--
DROP TABLE IF EXISTS teachers;

--
-- Create table `teachers`
--
CREATE TABLE teachers (
  Name VARCHAR(50) NOT NULL,
  Id INT(11) NOT NULL AUTO_INCREMENT,
  `Position` VARCHAR(50) NOT NULL,
  Subject VARCHAR(50) NOT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 5,
AVG_ROW_LENGTH = 4096,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `subjects`
--
CREATE TABLE subjects (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Subject_name VARCHAR(50) NOT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create index `SUBJECT_NAME_UNIQUE` on table `subjects`
--
ALTER TABLE subjects 
  ADD UNIQUE INDEX SUBJECT_NAME_UNIQUE(Subject_name);

--
-- Create table `groups`
--
CREATE TABLE groups (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Group_number VARCHAR(50) NOT NULL,
  Study_year INT(11) NOT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create index `GROUP_NUM_UNIQUE` on table `groups`
--
ALTER TABLE groups 
  ADD UNIQUE INDEX GROUP_NUM_UNIQUE(Group_number);

--
-- Create table `classrooms`
--
CREATE TABLE classrooms (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Classroom_num INT(11) NOT NULL,
  Floor INT(11) NOT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create index `CLASSROOM_NUM_UNIQUE` on table `classrooms`
--
ALTER TABLE classrooms 
  ADD UNIQUE INDEX CLASSROOM_NUM_UNIQUE(Classroom_num);

--
-- Create table `timetable`
--
CREATE TABLE timetable (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Teacher_id INT(11) NOT NULL,
  Subject_id INT(11) NOT NULL,
  Classroom_Id INT(11) NOT NULL,
  Group_id INT(11) NOT NULL,
  Lesson_time DATETIME NOT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 12,
AVG_ROW_LENGTH = 2340,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create index `TIME_CLASSROOM_UNIQUE` on table `timetable`
--
ALTER TABLE timetable 
  ADD UNIQUE INDEX TIME_CLASSROOM_UNIQUE(Classroom_Id, Lesson_time);

--
-- Create index `TIME_GROUP_UNIQUE` on table `timetable`
--
ALTER TABLE timetable 
  ADD UNIQUE INDEX TIME_GROUP_UNIQUE(Group_id, Lesson_time);

--
-- Create index `TIME_TEACHER_UNIQUE` on table `timetable`
--
ALTER TABLE timetable 
  ADD UNIQUE INDEX TIME_TEACHER_UNIQUE(Teacher_id, Lesson_time);

--
-- Create foreign key
--
ALTER TABLE timetable 
  ADD CONSTRAINT FK_TIMETABL_CLASSROOM_CLASSROO FOREIGN KEY (Classroom_Id)
    REFERENCES classrooms(Id);

--
-- Create foreign key
--
ALTER TABLE timetable 
  ADD CONSTRAINT FK_TIMETABL_GROUPS_TI_GROUPS FOREIGN KEY (Group_id)
    REFERENCES groups(Id);

--
-- Create foreign key
--
ALTER TABLE timetable 
  ADD CONSTRAINT FK_TIMETABL_SUBJECTS__SUBJECTS FOREIGN KEY (Subject_id)
    REFERENCES subjects(Id) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Create foreign key
--
ALTER TABLE timetable 
  ADD CONSTRAINT FK_TIMETABL_TEACHERS__TEACHERS FOREIGN KEY (Teacher_id)
    REFERENCES teachers(Id) ON DELETE CASCADE ON UPDATE CASCADE;

-- 
-- Dumping data for table teachers
--
INSERT INTO teachers VALUES
('Ivanov Ivan Ivanovich', 1, 'Professor', 'Mathematical sciences'),
('Petrov Petr Petrovich', 2, 'Professor', 'Physical sciences'),
('Alexandrov Alexander Alexandrovich', 3, 'Professor', 'Natural sciences'),
('Dmitriev Dmitriy Dmitrievich', 4, 'Lecturer', 'Liberal arts');

-- 
-- Dumping data for table subjects
--
INSERT INTO subjects VALUES
(3, 'Algebra'),
(5, 'Geography'),
(1, 'Geometry'),
(2, 'Informatics'),
(4, 'Literature'),
(6, 'Physics');

-- 
-- Dumping data for table groups
--
INSERT INTO groups VALUES
(1, '3301', 1),
(2, '3302', 1),
(3, '3303', 2),
(4, '3304', 2),
(5, '3305', 3),
(6, '3306', 4);

-- 
-- Dumping data for table classrooms
--
INSERT INTO classrooms VALUES
(1, 200, 1),
(2, 201, 2),
(3, 202, 2),
(4, 300, 3),
(5, 302, 3),
(6, 203, 2);

-- 
-- Dumping data for table timetable
--
INSERT INTO timetable VALUES
(1, 1, 1, 1, 1, '2020-03-09 13:30:00'),
(2, 1, 3, 1, 1, '2020-03-09 15:00:00'),
(3, 2, 6, 2, 1, '2020-04-09 13:30:00'),
(5, 2, 6, 1, 2, '2020-04-09 15:00:00'),
(6, 3, 5, 3, 3, '2020-05-09 15:00:00'),
(7, 3, 5, 3, 4, '2020-05-09 13:30:00'),
(11, 4, 4, 4, 3, '2020-05-09 13:30:00');

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;